#+TITLE: Starter Kit CC
#+OPTIONS: toc:nil num:nil ^:nil

* Starter Kit CC

** ff-find-other-file

+ Use ff-find-other-file command to goto header file quickly.
+ The search dirs are defined at [[~/.emacs.d/starter-kit-autocomplete.org][starter-kit-autocomplete]].
+ Do some hack to locate symbol at point after loading header file.
+ Use =makunbound= to remove variable. (=fmakunbound= to remove function).

#+begin_src emacs-lisp
(defun my-ff-get-symbol ()
  (setq __c-symbol-at-point (thing-at-point-no-properties 'symbol)))
(add-hook 'ff-pre-find-hook 'my-ff-get-symbol)

(defun my-ff-locate-symbol ()
  (when (and
         __c-symbol-at-point
         (string-match-p "\\.\\(h\\|hpp\\)" (buffer-name)))
    (goto-char (point-min))
    (re-search-forward (format "\\_<%s\\_>" __c-symbol-at-point) nil t)
    (makunbound '__c-symbol-at-point)))
(add-hook 'ff-post-load-hook 'my-ff-locate-symbol)
#+end_src

** Configurations

#+BEGIN_SRC emacs-lisp
(defun my-c-common-config ()
  (modify-syntax-entry ?_ "w")
  (c-set-offset 'substatement-open 0)
  (local-set-key (kbd "C-x C-o") 'ff-find-other-file)
  (when (> emacs-minor-version 3)
    (setq prettify-symbols-alist
          '(("!=" . ?≠)
            (">=" . ?≥)
            ("<=" . ?≤)))
    (prettify-symbols-mode 1)))
(add-hook 'c-mode-common-hook 'my-c-common-config)
#+END_SRC
